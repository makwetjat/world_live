---
- hosts: test:dev
  become: true
  become_user: progress
  
  tasks:   
    - name: create temp directory
      file: path=/apps/ansible/temp/zabbix state=directory owner=progress group=progress mode=775
      
    - name: Transfer the tarball
      copy: src=/apps/ansible/zabbixscripts.tgz dest=/apps/ansible/ owner=progress group=progress 
      register: result_copy
     
    - name: uncompressing the tarball
      shell: tar xvzf /apps/ansible/zabbixscripts.tgz /apps/ansible/temp/zabbix/
      register: uncompress_check
    - debug: msg="tarball successfully uncompressing"
      when: uncompress_check.rc == 0
    
    - name: remove the scripts on managed hosts after adding users
      file: path=/apps/ansible/temp/zabbix state=absent
      register: deldir_check
    - debug: msg="temp dir deleted on managed hosts"
      when: deldir_check.rc == 0
